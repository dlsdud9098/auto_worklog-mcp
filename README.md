# auto_worklog-mcp

Claude와의 대화를 자동으로 작업일지로 저장하는 MCP (Model Context Protocol) 서버

## 🎯 주요 특징

- **파일 시스템 전용**: 일지 파일 생성 및 관리에만 집중
- **브랜치별 폴더 구조**: 브랜치명을 폴더명으로 사용하여 작업일지 관리
- **GitHub MCP 연동**: Git 작업은 GitHub MCP를 통해 수행
- **자동 Git 동기화**: AUTO_GIT_SYNC=true 시 GitHub MCP 명령어를 자동으로 안내

## 📋 기능

- 📝 대화 내용을 체계적인 폴더 구조로 저장
- 📊 일일 작업 요약 자동 생성
- 🏷️ 브랜치별 폴더 구조로 작업 관리
- 📂 날짜별 자동 분류

## 🚀 설치

### 1. 저장소 클론 및 의존성 설치

```bash
git clone https://github.com/dlsdud9098/auto_worklog-mcp.git
cd auto_worklog-mcp
npm install
npm run build
```

### 2. Claude 설정

#### Claude Desktop 설정
**macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`  
**Windows**: `%APPDATA%\Claude\claude_desktop_config.json`  
**Linux**: `~/.config/Claude/claude_desktop_config.json`

#### Claude Code (VS Code) 설정
**macOS**: `~/Library/Application Support/Code/User/settings.json`  
**Windows**: `%APPDATA%\Code\User\settings.json`  
**Linux**: `~/.config/Code/User/settings.json`

#### Claude Desktop 설정 예시

```json
{
  "mcpServers": {
    "auto_worklog": {
      "command": "node",
      "args": ["/home/apic/python/auto_worklog-mcp/dist/index.js"],
      "env": {
        "WORKLOG_PATH": "/home/apic/python/worklog",
        "WORK_BRANCH": "Inyoung",
        "AUTO_GIT_SYNC": "true"
      }
    }
  }
}
```

#### Claude Code (VS Code) 설정 예시

```json
{
  "claude.mcpServers": {
    "auto_worklog": {
      "command": "node",
      "args": ["C:/Users/apic/Documents/GitHub/auto_worklog-mcp/dist/index.js"],
      "env": {
        "WORKLOG_PATH": "C:/Users/apic/Documents/GitHub/worklog",
        "WORK_BRANCH": "Inyoung",
        "AUTO_GIT_SYNC": "true"
      }
    }
  }
}
```

### 💡 설정 팁

- **WORK_BRANCH**: 브랜치명이 폴더명과 Git 브랜치명으로 사용됨
- **AUTO_GIT_SYNC**: `false`로 설정하면 수동으로 Git 작업 수행
- **GitHub MCP 필수**: Git 작업을 위해 GitHub MCP가 설정되어 있어야 함

## ⚙️ 환경 변수 설정

### 필수 환경 변수
- `WORKLOG_PATH`: 작업일지 저장 경로 (기본값: `/home/apic/python/worklog`)
- `WORK_BRANCH`: 작업 브랜치명 (기본값: `main`) - 폴더명과 Git 브랜치명으로 사용

### 선택 환경 변수
- `AUTO_GIT_SYNC`: Git 자동 동기화 활성화 (`true`/`false`)

## 📁 폴더 구조

```
${WORKLOG_PATH}/
├── 개발일지/
│   └── ${WORK_BRANCH}/
│       └── YYYY-MM-DD/
│           ├── 001-메인 페이지 수정.md
│           ├── 002-배포 스크립트 개선.md
│           └── 003-이미지 변환 모듈 추가.md
└── 요약/
    └── ${WORK_BRANCH}/
        └── YYYY-MM-DD-요약.md
```

**중요**: 브랜치명이 폴더명으로 사용되며, 해당 브랜치로 Git 작업이 수행됩니다.

## 📝 파일명 규칙

- **개발일지**: `[3자리번호]-작업내용요약.md`
  - 번호: 001부터 당일 기준 순차 증가
  - 요약: 50자 이내, 특수문자 제거
- **요약파일**: `YYYY-MM-DD-요약.md`

## 📄 파일 내용 템플릿

### 개발일지
```markdown
# [작업 제목]

Date: YYYY-MM-DD
Branch: [브랜치명]
Log Number: [순번]

---

[대화 내용]

---

*Generated by auto_worklog-mcp at [타임스탬프]*
```

### 요약파일
```markdown
# Daily Summary - YYYY-MM-DD

Branch: [브랜치명]
Total Logs: [N]

## 작업 목록

- [001] 메인 페이지 수정
- [002] 배포 스크립트 개선
- [003] 이미지 변환 모듈 추가

---

*Auto-generated summary*
```

## 🔧 사용법

Claude Desktop 또는 Claude Code를 재시작한 후 MCP 도구를 사용합니다.

### Claude Code에서 사용
1. VS Code에서 Claude Code 확장 설치
2. `settings.json`에 `claude.mcpServers` 설정 추가
3. VS Code 재시작
4. Claude Code 패널에서 MCP 명령 사용

### CLI에서 사용

```bash
# 작업일지 저장
/use auto_worklog saveConversation
content: "오늘 작업한 내용..."
summary: "메인 페이지 레이아웃 수정"
```

### 도구 목록

#### 1. 대화 저장

```
/use auto_worklog saveConversation
content: "대화 내용"
summary: "간단한 요약"
```

저장 결과: `/개발일지/${WORK_BRANCH}/2025-01-15/001-간단한 요약.md`

#### 2. 일일 요약 생성

```
/use auto_worklog createDailySummary
date: "2025-01-15"  # 선택사항, 기본값은 어제
```

#### 3. 로그 목록 조회

```
/use auto_worklog listLogs
branch: "feature/my-work"  # 선택사항
date: "2025-01-15"  # 선택사항
```

#### 4. 최근 요약 조회

```
/use auto_worklog getLastSummary
```

## 🔄 Git 작업 연동

### 자동 모드 (AUTO_GIT_SYNC=true)

#### 방법 1: Claude 프로젝트 지침 사용 (권장)
1. Claude 프로젝트에 `CLAUDE.md` 파일 추가
2. Claude가 자동으로 작업일지 저장 후 GitHub MCP 명령 실행
3. 별도 작업 없이 자동 Git 동기화

#### 방법 2: 커스텀 프롬프트 사용
```
# 프롬프트에 추가
AUTO_GIT_SYNC=true일 때 auto_worklog 실행 후 자동으로:
1. /use github checkout -b [WORK_BRANCH]
2. /use github add .
3. /use github commit -m "docs: 작업일지 추가"
4. /use github push
```

#### 방법 3: 수동 실행
작업일지 저장 후 제공되는 GitHub MCP 명령어를 복사하여 실행

### 수동 모드 (AUTO_GIT_SYNC=false)
GitHub MCP를 사용하여 Git 작업 수행:
```bash
# 브랜치 생성/전환
/use github checkout -b feature/my-work

# 변경사항 커밋 및 푸시
/use github add .
/use github commit -m "docs: [feature/my-work] 작업일지 추가"
/use github push -u origin feature/my-work

# PR 생성
/use github pr create --title "[브랜치명] 작업일지" --body "작업일지 PR"
```

## 💡 워크플로우 예시

### 일일 작업 흐름

1. **작업일지 저장**
   ```bash
   /use auto_worklog saveConversation
   content: "메인 페이지 반응형 디자인 구현..."
   summary: "반응형 레이아웃 적용"
   ```

2. **GitHub MCP로 Git 작업**
   ```bash
   # 변경사항 커밋 및 푸시
   /use github add .
   /use github commit -m "docs: [feature/my-work] 작업일지 추가"
   /use github push
   
   # PR 생성 (필요시)
   /use github pr create --title "[브랜치명] 작업일지"
   ```

3. **파일 저장 결과**
   ```
   개발일지/feature-my-work/2025-01-15/
   ├── 001-반응형 레이아웃 적용.md
   ├── 002-CI CD 파이프라인 설정.md
   └── 003-이미지 최적화 기능.md
   ```

## 🚨 문제 해결

### 브랜치 관리
- WORK_BRANCH가 폴더명과 Git 브랜치명으로 사용됨
- 새 브랜치 생성 시 자동으로 Git 브랜치 생성

### 파일 번호 관리
- 번호는 날짜별로 초기화 (매일 001부터 시작)
- 동시 작업 시 자동으로 다음 번호 할당

### 경로 오류
- `WORKLOG_PATH`가 올바른 경로인지 확인
- 해당 디렉토리에 쓰기 권한이 있는지 확인

## 🤖 Claude 자동화 설정

### CLAUDE.md 파일 사용
프로젝트 루트에 `CLAUDE.md` 파일이 있으면 Claude가 자동으로 Git 동기화를 수행합니다.

### 프롬프트 템플릿
`prompts/auto-git-sync.md` 파일을 Claude 대화에 복사하여 사용할 수 있습니다.

### Cursor IDE 설정
`.cursorrules` 파일이 Cursor IDE에서 자동 완성 및 제안을 제공합니다.

## 📌 버전 정보

- **v3.5.0**: Claude 자동화 지원 (CLAUDE.md, 프롬프트 템플릿)
- **v3.4.0**: GitHub MCP 연동 방식으로 변경
- **v3.2.0**: Git 자동 동기화 기능 추가 (AUTO_GIT_SYNC)
- **v3.0.0**: 브랜치별 폴더 구조로 변경
- **v2.0.0**: Git 기능 분리, 파일 관리 전용
- **v1.0.0**: 초기 버전

## 📜 라이선스

MIT